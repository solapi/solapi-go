# Scope

이 파일의 규칙은 `v2/` 디렉터리 및 모든 하위 디렉터리에 적용됩니다.
또한, [기존 루트 프로젝트 규칙](../AGENTS.md)도 같이 적용합니다.

# Go 코드 파일 길이 규칙 (모듈화)

- `v2/` 내에 작성·수정되는 모든 Go 소스 파일(`*.go`, 테스트 포함)은 파일 당 100줄을 초과하지 않아야 합니다.
- 100줄을 초과하게 될 경우 반드시 파일을 분리하거나 하위 패키지/모듈로 기능을 쪼개어 모듈화하세요.
- 줄 수(line) 계산은 공백/주석/임포트 등 파일의 모든 행을 포함합니다.

# 모듈화 가이드

- 단일 책임 원칙을 지켜 기능 단위로 파일을 분리하세요.
- 공용 API와 내부 구현을 `internal/` 또는 하위 패키지로 구분하세요.
- 함수는 가능한 20~30줄 내로 유지하고, 중복 로직은 추출하여 재사용하세요.
- 파일명은 책임/도메인을 드러내도록 명확히 짓습니다. 예: `transport/http_client.go`, `serialization/json_encoder.go`.
- 단 types.go와 같은 단순 타입 명시 파일은 100줄 이상으로 작성할 수 있습니다.

# 검증 방법

아래 명령으로 100줄을 초과하는 파일을 확인할 수 있습니다.

```bash
find . -type f -name '*.go' \
  -exec sh -c 'for f in "$@"; do n=$(wc -l <"$f"); [ "$n" -gt 100 ] && echo "$n $f"; done' _ {} + | sort -nr
```

출력이 있다면 해당 파일은 규칙 위반이므로 모듈화를 통해 분리해야 합니다.

# TDD / Tidy First 연계

- 구조적 변경(파일 분리/이동/이름 변경)과 행위 변경(기능 추가/수정)을 분리하여 진행하세요.
- 테스트는 작은 단위로 추가하고, 실패하는 가장 단순한 테스트부터 작성합니다.
- 테스트가 모두 통과한 후에만 리팩터링(분리/이름정리/중복제거)을 수행합니다.

